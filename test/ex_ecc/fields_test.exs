defmodule ExEcc.FieldsTest do
  use ExUnit.Case
  alias ExEcc.Fields.OptimizedBLS12381FQ12, as: FQ12
  alias ExEcc.FieldMath

  @ref_mul_input FQ12.new(
                   {0,
                    1_295_966_280_564_920_301_633_669_126_993_182_664_460_442_447_255_135_566_892_593_574_072_190_111_457_594_458_882_525_666_368_533_822_152_770_435_497_189,
                    0, 0, 0, 0, 0,
                    3_059_144_344_244_213_709_971_259_814_753_781_636_986_470_325_476_647_558_659_373_206_291_635_324_768_958_432_433_509_563_104_347_017_837_885_763_365_758,
                    0, 0, 0, 0}
                 )
  @ref_mul_output FQ12.new(
                    {0, 0,
                     2_886_146_602_942_164_659_301_167_814_677_733_485_256_874_702_798_106_380_073_023_842_792_495_045_256_740_963_189_437_433_355_555_792_468_866_690_988_225,
                     0, 0, 0, 0, 0,
                     3_113_349_101_563_180_256_960_455_051_481_244_719_726_682_130_931_247_942_710_023_183_696_345_206_282_753_395_927_436_272_834_951_815_958_170_074_391_256,
                     0, 0, 0}
                  )

  test "mul" do
    assert FieldMath.mul(@ref_mul_input, @ref_mul_input) == @ref_mul_output
  end

  @ref_pow_input FQ12.new(
                   {0,
                    1_295_966_280_564_920_301_633_669_126_993_182_664_460_442_447_255_135_566_892_593_574_072_190_111_457_594_458_882_525_666_368_533_822_152_770_435_497_189,
                    0, 0, 0, 0, 0,
                    3_059_144_344_244_213_709_971_259_814_753_781_636_986_470_325_476_647_558_659_373_206_291_635_324_768_958_432_433_509_563_104_347_017_837_885_763_365_758,
                    0, 0, 0, 0}
                 )
  @ref_pow_output FQ12.new(
                    {0, 0, 0,
                     1_208_014_699_426_624_783_375_932_104_263_102_727_186_685_859_915_238_178_215_830_609_707_270_486_764_961_217_177_702_174_011_273_874_707_328_702_625_266,
                     0, 0, 0, 0, 0,
                     2_133_050_398_774_337_206_222_816_300_118_221_327_418_763_981_033_055_222_570_091_459_262_312_519_047_975_404_484_651_902_003_138_703_421_962_555_090_218,
                     0, 0}
                  )

  test "pow" do
    assert FieldMath.pow(@ref_pow_input, 3) == @ref_pow_output
  end
end
